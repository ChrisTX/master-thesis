\documentclass[../thesis.tex]{subfiles}

\begin{document}
\chapter{Introduction to the control problem}
\label{sec:OptimalControlProblem}
A common issue is the control of a heating process: One has a domain $\Omega$ and intends to heat it in order to bring it to a desired state $y_\Omega (x)$.
To this end, one might have a heating control $u(x, t)$ inside the domain or at its boundary and a given state $y_0 (x)$ at the starting point.
The question would be how to make use of said control in order to attain a desired distribution of heat while at the same time minimizing the energy required.
In a further step, one might also introduce limitations to the heat control by for example adding pointwise box constraints to the control.

Given that an control attaining the desired end-time state does not have to exist, one uses a functional that is to be minimized, consisting out of the squared error in the final state associated with the control and the energy required for the control.

For a boundary control, that is to say a heating element at the boundary of a domain, one obtains the following optimization problem (cf.\ \cite[pp.\ 95, 123ff.]{Troeltzsch}):
\begin{equation}
\label{eq:BoundaryOptimalControl}
\begin{IEEEeqnarraybox}[][c]{c}
\min J(y, u) = \frac{1}{2} \int_\Omega \left( y(x, T) - y_\Omega(x) \right)^2 \dd x + \frac{\lambda}{2} \int_0^T \int_{\partial \Omega} u(x, t)^2 \dd s(x) \dd t \\
\noalign{\noindent subject to\vspace{\jot}}
\begin{IEEEeqnarraybox}{rCl"l}
\frac{\partial y}{\partial t} - \lapl y &=& 0 & \text{in } Q \coloneqq \Omega \times (0, T) \\
\partial_\nu y + \alpha y &=& \beta u & \text{in } \Sigma \coloneqq \partial \Omega \times (0, T) \\
y(x, 0) &=& y_0(x) & \text{in } \Omega
\end{IEEEeqnarraybox} \\
\noalign{\noindent and\vspace{\jot}}
u_a(x, t) \leq u(x, t) \leq u_b(x, t) \quad \text{a.e.\ in $\Sigma$}.
\end{IEEEeqnarraybox}
\end{equation}
The partial differential equation system for the state $y$ is the instationary heat equation with mixed boundary conditions.
Several parameters are available, namely $\lambda$ for weighting the impact of the energy required for $u(x, t)$, $\alpha$ and $\beta$ for balancing the heating effect.
From a physical point of view, the correct boundary conditions are to choose the same value for $\alpha$ and $\beta$, and thus obtaining
\[
	\partial_\nu y = \alpha( u - y )
\]
on the boundary. Physics calls $\alpha$ the heat diffusivity, which depends on the material in which the heat distribution is considered. In fact, the physically correct form of the equation itself would be
\[
	\frac{\partial y}{\partial t} - \alpha \lapl y = 0.
\]
For a mathematical treatment the form given above is sufficient, however. Upon implementing the method discussed here one should to keep these caveats in mind when it comes to working with a specific heating problem on a given material.

Analogously, one can establish the problem with an instationary, inner temperature source. This leads to the following formulation (cf.\ \cite[p.\ 124ff.]{Troeltzsch}):
\begin{equation}
\label{eq:InnerOptimalControl}
\begin{IEEEeqnarraybox}[][c]{c}
\min J(y, u) = \frac{1}{2} \iint_\Sigma \left( y(x, T) - y_\Sigma(x) \right)^2 \dd s(x) \dd t + \frac{\lambda}{2} \iint_Q u(x, t)^2 \dd s(x) \dd t \\
\noalign{\noindent subject to\vspace{\jot}}
\begin{IEEEeqnarraybox}{rCl"l}
\frac{\partial y}{\partial t} - \lapl y &=& \beta u & \text{in } Q\\
\partial_\nu y &=& 0 & \text{in } \Sigma \\
y(x, 0) &=& y_0(x) & \text{in } \Omega
\end{IEEEeqnarraybox} \\
\noalign{\noindent and\vspace{\jot}}
u_a(x, t) \leq u(x, t) \leq u_b(x, t) \quad \text{a.e.\ in $Q$}.
\end{IEEEeqnarraybox}
\end{equation}
Unlike previously, the desired temperature on the boundary $y_\Sigma$ is needed in this formulation. 

For now, we'll consider the boundary heating problem with any pointwise restrictions to the control omitted.
Without going into details here, % TODO: adjoined state chapter
one introduces a so called adjoint state $p$ for a given state $y$ that adheres to the following system of equations
\begin{IEEEeqnarray*}{rCl"l}
-\frac{\partial p}{\partial t} - \lapl y &=& 0 & \text{in } Q \\
\partial_\nu p + \alpha p &=& 0 & \text{in } \Sigma \\
p(x, T) &=& y (x, T) - y_\Omega(x) & \text{in } \Omega
\end{IEEEeqnarray*}
One can show (see for example \cite[Satz 3.20, p.\ 129]{Troeltzsch}) that a control $\bar{u}$ with associated state $\bar{y}$ is optimal if and only if the projection formula
\[
	\bar{u}(x, t) = \projP_{[u_a(x, t), u_b(x, t)]} \left\{ - \frac{1}{\lambda} \beta(x, t) p(x, t) \right\}
\]
holds, provided that $\lambda > 0$.
For the case $\lambda = 0$, one obtains an analogous projection formula on the bounds depending on the sign of $\beta(x, t) p(x, t)$, with unknown behavior at points where $\beta(x, t) p(x, t) = 0$. In this text, only the case $\lambda > 0$ is considered.
As we're going to omit the pointwise control restrictions, i.e.\ $u_a = - \infty$ and $u_b = \infty$, we instead arrive at
\[
	\bar{u}(x, t) = - \frac{1}{\lambda} \beta(x, t) p(x, t)
\]
By replacing $u$ with the right hand side this  equation, we obtain the optimality system
\begin{IEEEeqnarray*}{c}
\begin{IEEEeqnarraybox}{r"l}
\begin{IEEEeqnarraybox}{rCl}
\frac{\partial y}{\partial t} - \lapl y &=& 0 \\
\partial_\nu y + \alpha y &=& - \beta^2 \lambda^{-1} p \\
y(0) &=& y_0
\end{IEEEeqnarraybox} & 
\begin{IEEEeqnarraybox}{rCl}
-\frac{\partial p}{\partial t} - \lapl p &=& 0 \\
\partial_\nu p + \alpha p &=& 0 \\
p(T) &=& y(T) - y_\Omega
\end{IEEEeqnarraybox}
\end{IEEEeqnarraybox} \\
u = - \lambda^{-1} \beta p
\end{IEEEeqnarray*}
While this system can be solved as-is, the intertwining of the state and the adjoined state equations, and especially the fact that one is operating forward in time and the other one backwards in time, make this a difficult system to solve.

In \cite{Neumueller}, a space-time discontinuous Galerkin method for the parabolic heat equation has been derived. The approach made here will be to take said discretization, derive the corresponding discrete adjoint problem to then ultimately prove convergence of the discretized solution towards the continuous solution.
The first step will be therefore to introduce and to expand the space-time discontinuous Galerkin method.
\end{document}