\documentclass[../thesis.tex]{subfiles}

\begin{document}
\chapter{Introduction to the control problem}
\label{sec:OptimalControlProblem}
A common issue is the control of a heating process: One has a domain $\Omega$ and intends to heat it in order to bring it to a desired state $y_\Omega (x)$.
To this end, one might have a heating control $u(x, t)$ inside the domain or at its boundary and a given state $y_0 (x)$ at the starting point.
The question would be how to make use of said control in order to attain a desired distribution of heat while at the same time minimizing the energy required.
In a further step, one might also introduce limitations to the heat control by for example adding pointwise box constraints to the control.

Given that an control attaining the desired end-time state does not have to exist, one uses a functional that is to be minimized, consisting out of the squared error in the final state associated with the control and the energy required for the control.

For a boundary control, that is to say a heating element at the boundary of a domain, one obtains the following optimization problem (cf.\ \cite[pp.\ 95, 123ff.]{Troeltzsch}):
\begin{IEEEeqnarray*}{c}
\min J(y, u) = \frac{1}{2} \int_\Omega \left( y(x, T) - y_\Omega(x) \right)^2 \dd x + \frac{\lambda}{2} \int_0^T \int_{\partial \Omega} u(x, t)^2 \dd s(x) \dd t \\
\noalign{\noindent subject to\vspace{\jot}}
\begin{IEEEeqnarraybox}[][c]{rCl"l}
\frac{\partial y}{\partial t} - \lapl y &=& 0 & \text{in } Q \coloneqq \Omega \times (0, T) \\
\partial_\nu y + \alpha y &=& \beta u & \text{in } \Sigma \coloneqq \partial \Omega \times (0, T) \\
y(x, 0) &=& y_0(x) & \text{in } \Omega
\end{IEEEeqnarraybox} \\
\noalign{\noindent and\vspace{\jot}}
u_a(x, t) \leq u(x, t) \leq u_b(x, t) \quad \text{a.e.\ in $\Sigma$}.
\end{IEEEeqnarray*}
The partial differential equation for the state $y$ is the instationary heat equation with mixed boundary conditions.
Several parameters are available, namely $\lambda$ for weighting the impact of the energy required for $u(x, t)$, $\alpha$ and $\beta$ for balancing the heating effect.
We assume here and in the following that $\lambda \geq 0$ and $\alpha \geq 0$ are constants and that $\beta \in L^\infty(\Sigma)$ with $\beta \geq 0$ almost everywhere.

From a physical point of view, the correct boundary conditions are to choose the same value for $\alpha$ and $\beta$, and thus obtaining
\[
	\partial_\nu y = \alpha( u - y )
\]
on the boundary. Physics calls $\alpha$ the heat diffusivity, which depends on the material in which the heat distribution is considered.
Another simplification has been made in this formulation: The physically correct form of the equation itself would be to multiply the Laplace term with the heat diffusivity as well, i.e.
\[
	\frac{\partial y}{\partial t} - \alpha \lapl y = 0.
\]
For a mathematical treatment the form given above is sufficient, and it makes sense to separate $\alpha$ and $\beta$ for this purpose. Upon implementing the method discussed here one should to keep these caveats in mind when it comes to working with a specific heating problem on a given material.

Analogously, one can establish the problem with an instationary, inner temperature source. This leads to the following formulation (cf.\ \cite[p.\ 124ff.]{Troeltzsch}):
\begin{IEEEeqnarray*}{c}
\min J(y, u) = \frac{1}{2} \iint_\Sigma \left( y(x, T) - y_\Sigma(x) \right)^2 \dd s(x) \dd t + \frac{\lambda}{2} \iint_Q u(x, t)^2 \dd s(x) \dd t \\
\noalign{\noindent subject to\vspace{\jot}}
\begin{IEEEeqnarraybox}{rCl"l}
\frac{\partial y}{\partial t} - \lapl y &=& \beta u & \text{in } Q\\
\partial_\nu y &=& 0 & \text{in } \Sigma \\
y(x, 0) &=& 0 & \text{in } \Omega
\end{IEEEeqnarraybox} \\
\noalign{\noindent and\vspace{\jot}}
u_a(x, t) \leq u(x, t) \leq u_b(x, t) \quad \text{a.e.\ in $Q$}.
\end{IEEEeqnarray*}
Unlike previously, the desired temperature on the boundary $y_\Sigma$ is needed in this formulation. 

Let us consider the boundary heating problem for now.
Without going into details just yet, see \cref{sec:Disc-Control-Problem}, one introduces a so called adjoint state $p$ for a given state $y$ that adheres to the following system of equations
\begin{IEEEeqnarray*}{rCl"l}
-\frac{\partial p}{\partial t} - \lapl y &=& 0 & \text{in } Q \\
\partial_\nu p + \alpha p &=& 0 & \text{in } \Sigma \\
p(x, T) &=& y (x, T) - y_\Omega(x) & \text{in } \Omega
\end{IEEEeqnarray*}
One can show (see for example \cite[Satz 3.20, p.\ 129]{Troeltzsch}) that a control $\bar{u}$ with associated state $\bar{y}$ is optimal if and only if the projection formula
\[
	\bar{u}(x, t) = \projP_{[u_a, u_b]} \left\{ - \frac{1}{\lambda} \beta(x, t) p(x, t) \right\}
\]
holds, provided that $\lambda > 0$.
For the case $\lambda = 0$, one obtains an analogous projection formula on the bounds depending on the sign of $\beta(x, t) p(x, t)$, with unknown behavior at points where $\beta(x, t) p(x, t) = 0$. In this text, only the case $\lambda > 0$ is considered.
If we omit the pointwise control restrictions, i.e.\ $u_a = - \infty$ and $u_b = \infty$, the projection becomes the identity, and we arrive at
\[
	\bar{u}(x, t) = - \frac{1}{\lambda} \beta(x, t) p(x, t).
\]
By replacing $u$ with the right hand side this equation, we obtain the optimality system
\begin{IEEEeqnarray*}{c}
\begin{IEEEeqnarraybox}{r"l}
\begin{IEEEeqnarraybox}{rCl}
\frac{\partial y}{\partial t} - \lapl y &=& 0 \\
\partial_\nu y + \alpha y &=& - \beta^2 \lambda^{-1} p \\
y(0) &=& y_0
\end{IEEEeqnarraybox} & 
\begin{IEEEeqnarraybox}{rCl}
-\frac{\partial p}{\partial t} - \lapl p &=& 0 \\
\partial_\nu p + \alpha p &=& 0 \\
p(T) &=& y(T) - y_\Omega
\end{IEEEeqnarraybox}
\end{IEEEeqnarraybox} \\
u = - \lambda^{-1} \beta p
\end{IEEEeqnarray*}
While this system can be solved as-is, the intertwining of the state and the adjoint state equations, and especially the fact that one is operating forward in time and the other one backwards in time, make this a difficult system to solve.
If one considers the control-constrained case, then this becomes an even harder nut to crack, as the right hand side of the state system now depends on a non-linear function. From a theoretical point of view, that does not matter, however, and \cref{sec:Disc-Control-Problem} will treat the constrained form.
In \cref{sec:st-numerics} we will discuss numerical methods for solving this problem, and will also treat the control-constrained case. It will however turn out to be much more difficult to work with than the unconstrained case.

For deriving a numerical approach, one needs to apply a numerical discretization of the heat system that governs the state. In the elliptic case, one might simply apply a conformal finite element method for this purpose. The work \cite{Hinze} analyzed error estimates for such an approach.
However, in the parabolic case, one traditionally uses semi-discretization methods, where one effectively uses discontinuous Galerkin methods in the time direction and conformal approaches in the space dimensions. For the parabolic optimal control case, such methods have been examined in \cite{MeidnerVexler-I,MeidnerVexler-II}.

However, the approach made in this text is a different one.
In \cite{Neumueller}, a space-time discontinuous Galerkin method for the parabolic heat equation has been derived.
In contrast to the approach of \cite{MeidnerVexler-I}, this method employs a discretization using a discontinuous Galerkin approach in both space and time and operates with elements that span the space-time cylinder.
We will be to take said discretization, derive the corresponding discrete adjoint problem to then ultimately prove in \cref{sec:Disc-Control-Problem} convergence of the discretized solution towards the continuous solution in a given sense.
The first step will be therefore to introduce and to expand the space-time discontinuous Galerkin method, which will take place in \cref{sec:dG-method}. In \cref{sec:dG-numerics} we will discuss convergence results for that method, and finally derive numerical methods for it in \cref{sec:st-numerics}.
Last, but not least, we will present numerical results for this method in \cref{sec:numerical-results}.
\end{document}